
1. Войти unux-пользователем postgres
2. Всосать ветку (develop)
3. Перейти в каталог db
3. Поправить config.cfg (если нужно изменить базу, пользователя)
4. Выполнить ./install/install.sh (Существующая база и пользователь будут удалены!)

5. Выполнить проверку ./tests/run_tests.sh
должны увидеть:

---------------------------------------------------------------------------------------------
-- db-0.0.14-2
---------------------------------------------------------------------------------------------

-- добавлен статус пользователя ADMIN
create type en_user_status as enum ('UNKNOWN', 'CONFIRMED_SINGLE', 'CONFIRMED', 'ADMIN');	

-- добавлены новые функции

----------------------------------------------------------------------------------
--  Добавление роли торговому профилю по profile.id 
--  Возвращает: 
--  Исключения: выбрасывается исключение 
--  Пример: 
----------------------------------------------------------------------------------
create or replace function carl_prof.addRole(p_prof_id int, p_role varchar) returns void


----------------------------------------------------------------------------------
--  Удаление роли торгового профиля по profile.id 
--  Возвращвет: 
--  Исключения: выбрасывается исключение 
--  Пример: 
----------------------------------------------------------------------------------
create or replace function carl_prof.removeRole(p_prof_id int, p_role varchar) returns void


----------------------------------------------------------------------------------
--  Проверка наличия роли для торгового профиля profile.id 
--  Возвращвет: Y - роль есть N - нет
--  Исключения: выбрасывается исключение 
--  Пример: 
----------------------------------------------------------------------------------
create or replace function carl_prof.hasRole(p_prof_id int, p_role varchar) returns varchar(1)


----------------------------------------------------------------------------------
--  Получение списка ролей для торгового профиля profile.id 
--  Возвращвет: список ролей строкой с разделителем ','
--  Исключения: выбрасывается исключение 
--  Пример: 
----------------------------------------------------------------------------------
create or replace function carl_prof.getRoleList(p_prof_id int) returns varchar

-- тесты выдают:
...
 ok 11 - Добавление роли subscriber юрику (profile.id) 1
 ok 12 - роль subscriber есть у юрика (profile.id) 1
 ok 13 - роли buyer у юрика (profile.id) 1 нет
 ok 14 - Добавление роли buyer юрику (profile.id) 1
 ok 15 - роль buyer есть у юрика (profile.id) 1
 ok 16 - роли юрика (profile.id) 1 теперь subscriber,buyer
 ok 17 - Удаление роли buyer у юрика (profile.id) 1
 ok 18 - роли buyer у юрика (profile.id) 1 нет



